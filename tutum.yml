#Note NEVER LINK TO THIS CONTAINER - that would be a huge security risk

s3-conf:
  image: vizzbuzz/s3-conf
  autorestart: always
  cpu_shares: 128
  mem_limit: 64m
  deployment_strategy: every_node
  environment:
    - AWS_ACCESS_KEY_ID=changeme
    - AWS_SECRET_ACCESS_KEY=changeme
    - S3_BUCKET=changeme
    - DEPLOY_ENV=dev
    - S3_CONF_KEY=test-key
  volumes:
    - /etc/s3-conf:/conf


#Check the logs to see this has worked.
test:
  image: centurylink/openssl
  autorestart: never
  command: sh -c "sleep 10; $(openssl enc -aes-256-cbc -d -a -k $S3_CONF_KEY -in /conf/env.sh.enc); set; ls -l /conf/* "
  environment:
    - S3_CONF_KEY=test-key
  volumes:
    - /etc/s3-conf:/conf:ro
